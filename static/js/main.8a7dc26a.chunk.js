(this["webpackJsonpmuse-react"]=this["webpackJsonpmuse-react"]||[]).push([[0],{12:function(t,e,n){},13:function(t,e,n){},14:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n.n(i),r=n(4),s=n.n(r),o=(n(12),n(1)),h=n(2),m=n(6),c=n(5),d=(n(13),22),u=11,g=22,f="serif",l=14,p=10,v=5,w=8,E=1.5,y=1.414,b=1e3,k=100,N=110,x=function(){function t(){Object(o.a)(this,t),this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.marginTop=void 0,this.marginBottom=void 0,this.marginLeft=void 0,this.marginRight=void 0,this.x=0,this.y=0,this.width=0,this.height=0,this.marginBottom=0,this.marginTop=0,this.marginLeft=0,this.marginRight=0}return Object(h.a)(t,[{key:"init",value:function(t,e,n,i,a,r){this.x=t,this.y=e,this.width=n,this.height=i,this.marginBottom=r,this.marginTop=r,this.marginLeft=a,this.marginRight=a}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.marginBottom=t.marginBottom,this.marginTop=t.marginTop,this.marginLeft=t.marginLeft,this.marginRight=t.marginRight}}]),t}();function O(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1;return n||i?a.a.createElement("rect",{className:e+"__border",transform:"translate("+t.marginLeft+","+t.marginTop+")",width:t.width,height:t.height,stroke:"blue",strokeWidth:"0.4",fill:"none"}):a.a.createElement(a.a.Fragment,null)}var L=function(){function t(e){Object(o.a)(this,t),this.n="",this.noteGroup=[],this.l=0,this.p=0,this.dx=0,this.notesY=[],this.pointsY=[],this.tailPointsX=[],this.dimens=new x;var n=JSON.parse(e);void 0!==n.n&&(this.n=n.n,this.generateGroup(),this.l=n.l,this.p=n.p),void 0!==n.dimens&&(this.dimens=n.dimens)}return Object(h.a)(t,[{key:"parse",value:function(t){}},{key:"stringify",value:function(){return JSON.stringify(this)}}]),Object(h.a)(t,[{key:"settle",value:function(){var t=this,e=this.dx+u+this.p*w,n=0,i=0;i+=this.l*v;var a=0;this.noteGroup.forEach((function(e,r){if(e.t<0){if(0===r)for(var s=-e.t;s>0;--s){var o=v;i+=o/2,t.pointsY.push(-i),i+=o/2}if(0!==r)for(var h=-e.t;h>0;--h){var m=v;a+=m/2,t.pointsY.push(a),a+=m/2,n+=m}}t.notesY.push(n);if(n+=d,a+=d,e.t>0)for(var c=e.t;c>0;--c){var u=v;a+=u/2,t.pointsY.push(a),a+=u/2,n+=u}}));for(var r=0;r<this.p;++r)this.tailPointsX.push(this.dx+u+(r+.5)*w);this.dimens.width=e,this.dimens.height=n,this.dimens.marginBottom=i}},{key:"generateGroup",value:function(){var t=this;this.n.split("|").forEach((function(e){for(var n=0;n<e.length;++n)if(e.charCodeAt(n)<=57&&e.charCodeAt(n)>=48||45===e.charCodeAt(n)){var i=e.substr(0,n),a=e.charAt(n),r=e.substr(n+1).length;0!==r&&"-"===e.charAt(n+1)&&(r=-r),t.noteGroup.push({x:i,n:a,t:r}),""!==i&&(t.dx=l/2);break}}))}}]),t}();var B=function(t){var e=t.note.dimens,n="muse-note";return a.a.createElement("g",{className:n,transform:"translate("+(e.x-e.marginLeft)+","+(e.y-e.marginTop)+")",width:e.width+e.marginLeft+e.marginRight,height:e.height+e.marginTop+e.marginBottom},O(e,n),function(t,e){return a.a.createElement("g",{className:e+"__group-note"},t.noteGroup.map((function(n,i){return a.a.createElement("g",{className:e+"__note-one",key:n.n+i+n.x,width:t.dimens.width,height:t.notesY[i],transform:"translate(0,"+(t.dimens.height-t.notesY[i])+")"},a.a.createElement("text",{fontFamily:f,fontSize:g,transform:"translate("+t.dx+",0)"},n.n),a.a.createElement("text",{fontFamily:f,fontSize:l,transform:"translate(0,"+(l-d)+")"},"S"===(r=n.x)?"#":"F"===r?"b":"DS"===r?"x":"DF"===r?"d":"N"===r?"n":""));var r})))}(t.note,n),function(t,e){return a.a.createElement("g",{className:e+"__group-point"},t.pointsY.map((function(e,n){return a.a.createElement("circle",{key:n,r:E,fill:"black",transform:"translate("+(t.dx+u/2)+","+(t.dimens.height-e+v/2)+")"})})))}(t.note,n),function(t,e){return a.a.createElement("g",{className:e+"__tail-point"},t.tailPointsX.map((function(e,n){return a.a.createElement("circle",{key:n,r:E,fill:"black",transform:"translate("+e+","+(t.dimens.height-d/3)+")"})})))}(t.note,n))},S=function(){function t(e){var n=this;Object(o.a)(this,t),this.notes=[],this.dimens=new x,this.unitNum=0,this.notesX=[],this.baselineGroup=[];var i=JSON.parse(e);void 0!==i.notes&&(i.notes.forEach((function(t){n.notes.push(new L(JSON.stringify(t)))})),this.generateBaseline(),this.notesX.push(1),this.notes.forEach((function(t,e){var i=0;void 0===n.notes[e+1]?i+=1:void 0!==n.notes[e+1]&&n.notes[e+1].l<t.l?i+=Math.pow(2,-n.notes[e+1].l):i+=Math.pow(2,-t.l);for(var a=1,r=1;r<=t.p;++r)a+=Math.pow(2,-r);i*=a,n.notesX.push(i),n.unitNum+=i}))),void 0!==i.dimens&&(this.dimens=i.dimens)}return Object(h.a)(t,[{key:"generateBaseline",value:function(){for(var t=this,e=function(e){var n=0,i=0,a=-1;if(t.notes.forEach((function(r,s){r.l>e?(a=s,n++):(i<=a&&t.baselineGroup.push({y:e,s:i,e:a}),i=s+1,a=s)})),i<=a&&t.baselineGroup.push({y:e,s:i,e:a}),0===n)return"break"},n=0;;++n){if("break"===e(n))break}}}]),t}();var T=function(t){var e=t.bar.dimens,n="muse-bar";return a.a.createElement("g",{className:n,transform:"translate("+(e.x-e.marginLeft)+","+(e.y-e.marginTop)+")",width:e.width+e.marginLeft+e.marginRight,height:e.height+e.marginTop+e.marginBottom},O(e,n),function(t,e){return a.a.createElement("line",{className:e+"__bar-line",x1:t.marginLeft+t.width+t.marginRight,y1:0,x2:t.marginLeft+t.width+t.marginRight,y2:t.height,strokeWidth:1,stroke:"black"})}(e,n),function(t,e){return a.a.createElement("g",{className:e+"__base-line"},t.baselineGroup.map((function(e,n){return a.a.createElement("line",{key:n,x1:t.notes[e.s].dimens.x,y1:t.notes[e.s].dimens.height+(e.y+1)*v,x2:t.notes[e.e].dimens.x+t.notes[e.e].dimens.width,y2:t.notes[e.s].dimens.height+(e.y+1)*v,stroke:"black",strokeWidth:1})})))}(t.bar,n),t.bar.notes.map((function(t){return a.a.createElement(B,{note:t,key:JSON.stringify(t)})})))},j=function t(e){var n=this;Object(o.a)(this,t),this.bars=[],this.dimens=new x;var i=JSON.parse(e);void 0!==i.bars&&i.bars.forEach((function(t){n.bars.push(new S(JSON.stringify(t)))})),void 0!==i.dimens&&(this.dimens=i.dimens)};var J=function(t){var e=t.track.dimens;return a.a.createElement("g",{className:"muse-track",transform:"translate("+(e.x-e.marginLeft)+","+(e.y-e.marginTop)+")",width:e.width+e.marginLeft+e.marginRight,height:e.height+e.marginTop+e.marginBottom},O(e,"muse-track"),t.track.bars.map((function(t,e){return a.a.createElement(T,{bar:t,key:e})})))},_=function t(e){var n=this;Object(o.a)(this,t),this.tracks=[],this.dimens=new x;var i=JSON.parse(e);void 0!==i.tracks&&i.tracks.forEach((function(t){n.tracks.push(new j(JSON.stringify(t)))})),void 0!==i.dimens&&(this.dimens=i.dimens)};var R=function(t){var e=t.line.dimens;return a.a.createElement("g",{className:"muse-line",transform:"translate("+(e.x-e.marginLeft)+","+(e.y-e.marginTop)+")",width:e.width+e.marginLeft+e.marginRight,height:e.height+e.marginTop+e.marginBottom},O(e,"muse-line"),function(t,e){return a.a.createElement("g",{className:e+"__line-head"},a.a.createElement("line",{x1:0,y1:0,x2:0,y2:t.height,strokeWidth:1,stroke:"black"}))}(e,"muse-line"),t.line.tracks.map((function(t){return a.a.createElement(J,{track:t,key:JSON.stringify(t)})})))},A=function t(e){var n=this;Object(o.a)(this,t),this.lines=[],this.dimens=new x;var i=JSON.parse(e);void 0!==i.lines&&i.lines.forEach((function(t){n.lines.push(new _(JSON.stringify(t)))})),void 0!==i.dimens&&(this.dimens=i.dimens)};var G=function(t){var e=t.page.dimens;return a.a.createElement("g",{className:"muse-page",transform:"translate("+(e.x-e.marginLeft)+","+(e.y-e.marginTop)+")",width:e.width+e.marginLeft+e.marginRight,height:e.height+e.marginTop+e.marginBottom},O(e,"muse-page"),function(t,e){return a.a.createElement("rect",{className:e+"__outer-border",transform:"translate(0,0)",width:t.width+t.marginLeft+t.marginRight,height:t.height+t.marginTop+t.marginBottom,stroke:"gray",strokeWidth:"0.4",fill:"none"})}(e,"muse-page"),t.page.lines.map((function(t){return a.a.createElement(R,{line:t,key:JSON.stringify(t)})})))},Y=function t(e){var n=this;Object(o.a)(this,t),this.pages=[],this.dimens=new x;var i=JSON.parse(e);void 0!==i.pages&&i.pages.forEach((function(t){n.pages.push(new A(JSON.stringify(t)))})),void 0!==i.dimens&&(this.dimens=i.dimens)};var W=function(t){var e=t.notation.dimens;return a.a.createElement("svg",{className:"muse",width:t.notation.dimens.width+20,height:t.notation.dimens.height+20},a.a.createElement("g",{className:"muse-notation",transform:"translate(10,10)",width:t.notation.dimens.width,height:t.notation.dimens.height},O(e,"muse-notation"),t.notation.pages.map((function(t){return a.a.createElement(G,{page:t,key:JSON.stringify(t)})}))))};function X(t,e){var n=k,i=N,a=e-2*n,r=e*y-2*i,s=new Y(t),o=0;return s.pages.forEach((function(t,e){t.dimens.x=n,t.dimens.y=i*(e+1)+(i+r)*e,t.dimens.width=a,t.dimens.marginLeft=n,t.dimens.marginRight=n,t.dimens.height=r,t.dimens.marginTop=i,t.dimens.marginBottom=i,o+=t.dimens.marginTop+t.dimens.marginBottom+t.dimens.height;var s=[],h=t.dimens.height;t.lines.forEach((function(e){e.dimens.width=t.dimens.width,e.dimens.x=t.dimens.marginLeft;var n=0,i=0,a=[];e.tracks.forEach((function(t){t.bars.forEach((function(t,e){void 0!==a[e]?a[e]=a[e]>t.unitNum?a[e]:t.unitNum:a.push(t.unitNum)}))}));var r=a.reduce((function(t,e){return t+e}));e.tracks.forEach((function(t){var s;t.dimens.y=i,t.dimens.width=e.dimens.width;var o=0,h=0,m=0;t.bars.forEach((function(e,n){e.unitNum=a[n],e.dimens.width=a[n]/r*t.dimens.width,e.dimens.x=m,m+=e.dimens.width;var i=[];e.notes.forEach((function(t){t.settle();var e=t.dimens.width,n=t.dimens.height,a=t.dimens.marginBottom;o=o>n?o:n,h=h>a?h:a,i.push(e)}));var s=0;e.notes.forEach((function(t,n){s+=e.notesX[n]/(e.unitNum+1)*e.dimens.width,t.dimens.x=s-u/2-t.dx}))})),t.dimens.height=o+h,t.bars.forEach((function(e){e.dimens.height=t.dimens.height,e.notes.forEach((function(t){t.dimens.height=o,t.dimens.marginBottom=h}))})),n+=(s=o+h)+p,i+=s+p})),n-=p,e.dimens.height=n,h-=n,s.push(n)}));var m=h/(t.lines.length-1);t.lines.forEach((function(e,n){for(var i=t.dimens.marginTop,a=0;a<n;++a)i+=m+s[a];e.dimens.y=i}))})),s.dimens.width=a+2*n,s.dimens.height=o,s}var F=function(t){return a.a.createElement(W,{notation:X(t.data,t.width?t.width:b)})},M=function(t){Object(m.a)(n,t);var e=Object(c.a)(n);function n(t){var i;return Object(o.a)(this,n),(i=e.call(this,t)).state={errorA:null,errorB:null,isLoadedA:!1,isLoadedB:!1,a:"",b:""},i}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var t=this,e="";e="https://cdn.jsdelivr.net/gh/shizuku/muse-react/test/data/",fetch(e+"a.json").then((function(t){return t.text()})).then((function(e){t.setState({isLoadedA:!0,a:e})}),(function(e){t.setState({isLoadedA:!0,errorA:e})})),fetch(e+"b.json").then((function(t){return t.text()})).then((function(e){t.setState({isLoadedB:!0,b:e})}),(function(e){t.setState({isLoadedB:!0,errorB:e})}))}},{key:"render",value:function(){return a.a.createElement("div",{className:"app"},a.a.createElement("h2",null,"Example A"),this.state.isLoadedA?this.state.errorA?"error":a.a.createElement(F,{data:this.state.a}):"loading...",a.a.createElement("h2",null,"Example B"),this.state.isLoadedB?this.state.errorB?"error":a.a.createElement(F,{data:this.state.b}):"loading...")}}]),n}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},7:function(t,e,n){t.exports=n(14)}},[[7,1,2]]]);
//# sourceMappingURL=main.8a7dc26a.chunk.js.map